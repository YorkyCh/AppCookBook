{% extends 'base.html' %}

{% block extra_head %}
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const addIngredientButton = document.getElementById("add-ingredient");

      addIngredientButton.addEventListener("click", function() {
        const newIngredient = document.querySelector(".ingredient").cloneNode(true);
        document.getElementById("ingredients-container").appendChild(newIngredient);
      });
    });
  </script>
{% endblock %}

{% block content %}
  <h1>Create Recipe</h1>
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.as_p }}
    <h3>Ingredients:</h3>
    {{ formset.management_form }}
    <div id="ingredients-container">
      {% for form in formset %}
        <div class="ingredient">
          <div class="form-field">
            {{ form.ingredient.label_tag }} {{ form.ingredient }}
          </div>
          <div class="form-field">
            {{ form.amount.label_tag }} {{ form.amount }}
          </div>
        </div>
      {% endfor %}
    </div>
    <button type="button" id="add-ingredient">Add Ingredient</button>
    <h3>Categories:</h3>
    {% for category in categories %}
      <div>
        <input type="checkbox" name="categories" value="{{ category.pk }}" id="category_{{ category.pk }}">
        <label for="category_{{ category.pk }}">{{ category.name }}</label>
      </div>
    {% endfor %}
    <button type="submit">Create</button>
  </form>
{% endblock %}
